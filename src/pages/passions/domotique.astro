---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Domotique & Smart Home" description="Détails de mon installation domotique complète : Zigbee, Home Assistant, Node-Red, etc.">
  <div class="max-w-4xl mx-auto px-4 py-12 text-gray-300">
    
    <a href="/passions" class="inline-flex items-center text-blue-400 hover:text-blue-300 mb-8 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
      </svg>
      Retour aux passions
    </a>

    <h1 class="text-4xl font-bold text-white mb-6">Domotique & Smart Home</h1>
    <p class="text-xl text-gray-400 mb-12">Domotisation complète de mon habitation (2020 - aujourd'hui)</p>

    <div class="space-y-16">
      
      <!-- Intro & Objectifs -->
      <section>
        <h2 class="text-2xl font-semibold text-white mb-4 border-l-4 border-blue-500 pl-4">Objectifs & Philosophie</h2>
        <p class="mb-6">
          Automatiser une habitation en utilisant une solution <strong>universelle, modulable, gratuite et open-source</strong>.
          L'objectif est de s'affranchir des cloud propriétaires et de garder le contrôle total des données.
        </p>
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-gray-800 p-6 rounded-lg border border-green-900/50">
                <h3 class="text-lg font-bold text-green-400 mb-3">Avantages</h3>
                <ul class="list-disc list-inside space-y-2 text-sm">
                    <li>Indépendance totale (Cloud-free)</li>
                    <li>Coût très avantageux (Hardware DIY)</li>
                    <li>Fiabilité élevée et mises à jour fréquentes</li>
                    <li>Apprentissage technique constant (Réseau, Linux, MQTT)</li>
                </ul>
            </div>
             <div class="bg-gray-800 p-6 rounded-lg border border-red-900/50">
                <h3 class="text-lg font-bold text-red-400 mb-3">Inconvénients</h3>
                <ul class="list-disc list-inside space-y-2 text-sm">
                    <li>Temps de mise en place conséquent</li>
                    <li>Nécessite des compétences techniques variées</li>
                </ul>
            </div>
        </div>
      </section>

      <!-- ZigBee -->
      <section>
        <h2 class="text-2xl font-semibold text-white mb-6 border-l-4 border-blue-500 pl-4">Réseau ZigBee</h2>
        <p class="mb-4">
            Utilisation du protocole ZigBee pour sa faible consommation et son maillage réseau.
            Matériel : Valves thermostatiques Tuya, Capteurs Xiaomi (Temp/Hum/Porte/Présence), etc.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
             <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/xiaomi1.jpg" alt="Capteur Xiaomi" class="w-full h-48 object-cover">
                <div class="p-3 text-center text-sm font-medium">Capteurs Temp/Hum</div>
             </div>
             <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/xiaomi2.jpg" alt="Capteur Porte" class="w-full h-48 object-cover">
                <div class="p-3 text-center text-sm font-medium">Capteurs d'ouverture</div>
             </div>
             <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/tuya.jpg" alt="Valve Tuya" class="w-full h-48 object-cover">
                <div class="p-3 text-center text-sm font-medium">Vannes Thermostatiques</div>
             </div>
        </div>
      </section>

      <!-- Sniffer Zigbee & RPI -->
      <section>
         <h2 class="text-2xl font-semibold text-white mb-6 border-l-4 border-blue-500 pl-4">Infrastructure Serveur</h2>
         <p class="mb-4">
            Pour contrôler le tout, j'utilise un <strong>Raspberry Pi 4</strong> équipé d'un module sniffer <strong>PiZigate</strong>.
            C'est le coeur du système.
         </p>
         <div class=" bg-gray-600 rounded-lg p-6 mb-6">
            <h3 class="font-bold text-white mb-2">Challenges techniques :</h3>
            <ul class="list-disc list-inside space-y-1 text-sm text-gray-200">
                <li>Mapper le port série <code>/dev/ttyAMA0</code> vers le conteneur Docker</li>
                <li>Flasher le firmware de la PiZigate pour supporter le débit 115200 big-endian</li>
                <li>Sécurisation avec <strong>Fail2Ban</strong> (protection SSH) et <strong>Nginx Proxy Manager</strong></li>
            </ul>
         </div>
         <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
             <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/pizigate.jpg" alt="Raspberry Pi" class="w-full h-64 object-cover">
                <div class="p-4">
                    <h4 class="font-bold text-white">Le Serveur</h4>
                    <p class="text-sm">Boitier Argon One, SSD M.2 120Go, Onduleur UPS.</p>
                </div>
             </div>
              <div class="bg-gray-800 rounded-lg overflow-hidden border border-gray-700 p-4 flex flex-col justify-center">
                  <h4 class="font-bold text-white mb-3 text-lg">Stack Logicielle (Docker)</h4>
                  <ul class="space-y-2 text-sm text-gray-300">
                    <li class="flex items-center"><span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>Home Assistant (Core)</li>
                    <li class="flex items-center"><span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span>Zigbee2MQTT (Bridge Zigbee &harr; MQTT)</li>
                    <li class="flex items-center"><span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>Mosquitto (Broker MQTT)</li>
                    <li class="flex items-center"><span class="w-3 h-3 bg-red-500 rounded-full mr-2"></span>Node-Red (Automatisations complexes)</li>
                    <li class="flex items-center"><span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>InfluxDB + Grafana (Métriques & Logs)</li>
                    <li class="flex items-center"><span class="w-3 h-3 bg-gray-500 rounded-full mr-2"></span>Portainer (Gestion Docker)</li>
                  </ul>
             </div>
         </div>
      </section>

      <!-- Node Red & Automation -->
      <section>
        <h2 class="text-2xl font-semibold text-white mb-6 border-l-4 border-blue-500 pl-4">Automatisations Avancées (Node-Red)</h2>
        <p class="mb-6">
            Je préfère Node-Red aux automatisations natives de Home Assistant pour sa puissance visuelle et sa capacité à gérer des logiques complexes.
        </p>

        <div class="space-y-8">
            <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/nodered.jpg" alt="Flow Chauffage" class="w-full object-contain bg-white/5">
                <div class="p-4">
                    <h4 class="font-bold text-white mb-2">Exemple : Flow de Chauffage</h4>
                    <p class="text-sm">
                        Gestion intelligente qui croise plannings horaires, détection de présence, et ouverture des fenêtres pour optimiser la consommation.
                        Ajuste la température cible dynamiquement selon des variables globales définies dans Home Assistant.
                    </p>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg overflow-hidden">
                <img src="/images/projects/domotique/nodered2.jpg" alt="Flow Présence" class="w-full object-contain bg-white/5">
                <div class="p-4">
                    <h4 class="font-bold text-white mb-2">Exemple : Gestion de l'éclairage</h4>
                    <p class="text-sm">
                        Allumage adaptatif selon la luminosité ambiante (capteur Lux) et l'heure de la journée (Cycle Circadien : lumière froide le matin, chaude le soir).
                        Verrouillage manuel possible pour créer des ambiances.
                    </p>
                </div>
            </div>
        </div>
      </section>

      <!-- Dashboarding -->
      <section>
          <h2 class="text-2xl font-semibold text-white mb-6 border-l-4 border-blue-500 pl-4">Monitoring & Visualisation</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                   <h3 class="font-bold text-lg mb-2">Grafana + InfluxDB</h3>
                   <p class="text-sm text-gray-400 mb-4">Stockage à long terme des métriques (températures, consommation, humidité) pour analyser les tendances.</p>
                   <img src="/images/projects/domotique/grafana.jpg" class="rounded-lg shadow-lg border border-gray-700" alt="Grafana">
              </div>
               <div>
                   <h3 class="font-bold text-lg mb-2">Home Assistant (Lovelace)</h3>
                   <p class="text-sm text-gray-400 mb-4">Dashboard tactile utilisé au quotidien sur tablette murale et smartphone pour le contrôle direct.</p>
                   <img src="/images/projects/domotique/ha.jpg" class="rounded-lg shadow-lg border border-gray-700" alt="Home Assistant">
              </div>
          </div>
      </section>

    </div>
  </div>
</Layout>
